---
layout: post
title: User-ID使用指南
category : Universal Analytics
tags : [User-ID, Universal Analytics, Google Tag Manager]
---
{% include JB/setup %}

我的一个GA账户今天已经开通了User-ID功能，这里记录一些使用指南和使用心得。

总体来说，这是一个很时髦的功能，主要得益于近年来跨屏用户的不断增长，以及移动设备地增长率不断攀升。以用户为中心的数据分析，是如今大家都基本达成的一个共识，对于普遍意义的数据分析而言，日志时代早已远去，IP时渐行渐远，cookie时代当然还处于并将长期处于比较流行的跟踪方式。

Google Analytics推出的这个User-ID功能其实在去年的开发者大会就已经曝光了，知道前些天才开始逐步开放测试范围，应该最近一两个月内所有账户都可以用上这个功能了。

## 主要来说，新增的功能点有：

1.在受众群体的菜单下新增了一个“跨设备”的子菜单，其下再有“设备重叠”、“设备路径”、“流量获取设备”。

2.设备路径中支持主要维度的细分，并且可以对基本的转化数据和电子商务数据使用“定序工具”，所谓“定序工具”，其实就是一个针对设备流向的路径分析，可以了解基本的目标或目标元素（我自己给的一个称呼）的设备路径。如某个目标完成之前有哪些设备路径、目标完成之后有哪些目标路径，或者目标前后的所有完整路径。目标元素是指：事件类别、事件操作、事件标签、网页等，目标包括：电商交易次数、你设置的目标。

3.对于电商来说，新增了一些类似于笔单价和客单价的指标。在此前由于GA默认是以cookie为单位进行统计，因此没有上述指标，但是加入用户的概念后，我们就可以计算出每位用户所带来的的平均收入（相当于客单价），每位用户的平均交易次数（相当于交易次数，因此你可以通过指标计算得出笔单价）。

4.流量获取设备是指：用户最常所用设备，以及分别对应的用户数、会话、最初所用设备带来的收入、其他设备带来的收入、该设备所产生的收入汇总。对于电商而言，还可以了解各个“最初所用设备”产生的交易次数、每位用户所带来的的平均收入，每位用户的平均交易次数等指标。概括来说，就是可以按设备对应用户的汇总数据，并且对应到用户所使用的第一个设备。这是一个比较复杂的对应关系，因此GA目前也只是做了第一个设备的行为及转化细分和汇总。

## 使用User-ID这个功能，有一些前提条件：

1.一定要有一套会员系统、或者唯一身份识别体系，用户使用不同设备都能识别出来，并且用户有登陆的习惯。一般来说，电商网站是最适合的了。会员越多越好，数据越完整。并且用户要有登陆的习惯，有支持登陆的移动网站也是一个先决条件。

2.你需要升级到UA版本，GA版本是不支持这种跟踪。各种GA的功能UA都支持，考虑尽快升级吧。

3.数据量要比较大才有意义。因为User-ID视图相当于是一个过滤包含会员的数据视图，仅显示会员的数据，非会员的数据并不会显示，而且其他的视图并没有这种相关的报告。量小的话，User-ID视图筛选出来数据量太小很难分析出啥有代表性的数据来，很可能由于概率事件造成数据偏差。

User-ID功能的使用也比较简单，现在.JS跟踪信息设置中的User-ID子菜单中根据向导开通功能，然后在页面或者GTM中添加UID的跟踪代码即可。

GTM的话，在UA的代码设置中展开”要设置的字段“并设置为如下：

    &uid 对应的值为UID的宏

其中UID为你设置的会员ID宏，可以通过第一方cookie来提取、通过自定义javascript的宏进行提取、或者在页面前端新增相应的DataLayer再通过宏提取。

如果你直接使用UA的话，代码如下：

    'ga(‘set’, ‘&uid’, {{USER_ID}}); // 使用已登录的 user_id 来设置用户 ID。'

如果你在network中查看collect的请求，看到URL中有&uid=[userid]这个参数，那么就说明代码设置是成功了。接下来，等待数据就行了。
